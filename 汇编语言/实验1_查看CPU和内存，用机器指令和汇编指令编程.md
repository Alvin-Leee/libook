## 环境安装

- 在software中，有DOSBox和debug，分别解压到各自的文件夹
- 安装DOSBox，不安装debug
- 双击 Options.bat

![image-20210711000026191](assets\image-20210711000026191.png)

- 直接滑到末尾，挂载debug.exe，MOUNT是挂载，C是参数，后面是debug.exe的保存位置，最后两行直接执行命令

![image-20210711000516316](assets/image-20210711000516316.png)

- 输入dds:0，查看是否正常输出

![image-20210711000757710](assets/image-20210711000757710.png)



## 预备知识

### r命令：寄存器

---

- 功能：查看、改变CPU寄存器的内容

- 查看寄存器内容

![image-20210711001500131](assets/image-20210711001500131.png)

- 修改寄存器内容（-r 寄存器名）

![image-20210711002209241](assets/image-20210711002209241.png)



### d命令：内存

---

- 功能：查看内存中的内容，使用"d 段地址:偏移地址"的格式，列出128（即16*8）个内存单元的内容

![image-20210711110546168](assets/image-20210711110546168.png)

- 显示格式为——每行首地址 前8个字节：后8个字节 ASCII码显示
  - 若没有对应的ASCII码，就使用' . '来代替

- 偏移量不为0时如何显示——显示为空，如1000:9，前1000:0-1000:8的内容不显示，也是显示128个单元

![image-20210711111333537](assets/image-20210711111333537.png)

- 显示指定单元区间的内容，使用“d 段地址:起始偏移地址 结尾偏移地址”，如“d 1000:0 9”

![image-20210711111936099](assets/image-20210711111936099.png)



### e命令：修改内存

---

- 功能：修改内存中的内容
- 直接修改

![image-20210711121144650](assets/image-20210711121144650.png)

- 询问修改（输入后点击空格，再输入下一个）

![image-20210711121528123](assets/image-20210711121528123.png)

- 输入字符（单引号，双引号都可以）

![image-20210711121941731](assets/image-20210711121941731.png)

- 输入字符串（双引号，双引号都可以）

![image-20210711122622405](assets/image-20210711122622405.png)

- 输入汇编指令

![image-20210711123025207](assets/image-20210711123025207.png)



### u命令：翻译为机器指令

---

- 功能：查看机器码对应的机器指令

![image-20210711123913115](assets/image-20210711123913115.png)



### t命令：执行指令

---

- 功能：执行指令（首先应将CS和IP指向保存指令的位置）

![image-20210711125322152](assets/image-20210711125322152.png)

- 连续键入t，依次执行

![image-20210711125522113](assets/image-20210711125522113.png)



### a命令：写汇编指令

---

- 功能：直接输入汇编命令，自动将命令翻译为二进制

![image-20210711131907934](assets/image-20210711131907934.png)





## 实验开始

### 任务1：写入汇编指令，逐条执行，观察各寄存器变化

- 首先修改CS:IP为1000:0

![image-20210711132314198](assets/image-20210711132314198.png)

- 先将汇编指令写入内存中

![image-20210711132719404](assets/image-20210711132719404.png)

- 依次执行并查看各寄存器中的内容变化

- 第1条

![image-20210711153146627](assets/image-20210711153146627.png)

- 第2条

![image-20210711153220181](assets/image-20210711153220181.png)

- 第3条

![image-20210711153333870](assets/image-20210711153333870.png)

- 第4条

![image-20210711153407770](assets/image-20210711153407770.png)

- 第5条

![image-20210711153430234](assets/image-20210711153430234.png)

- 第6条（可以看出AX发生了溢出）

![image-20210711153458627](assets/image-20210711153458627.png)

- 第7条

![image-20210711153545197](assets/image-20210711153545197.png)

- 第8条

![image-20210711153610986](assets/image-20210711153610986.png)

- 第9条

![image-20210711153816296](assets/image-20210711153816296.png)

- 第10条

![image-20210711153843091](assets/image-20210711153843091.png)

- 第11条

![image-20210711153904354](assets/image-20210711153904354.png)

- 第12条

![image-20210711153935342](assets/image-20210711153935342.png)

- 第13条

![image-20210711154025105](assets/image-20210711154025105.png)

- 第14条（Al发生了溢出）

![image-20210711154104302](assets/image-20210711154104302.png)



### 任务2：计算2的8次方

- 将指令写入内存中（默认CS:IP已经修改为2000:0）

![image-20210711154428938](assets/image-20210711154428938.png)

- 依次执行，查看结果
- 第1条

![image-20210711155852796](assets/image-20210711155852796.png)

- 第2条

![image-20210711155915636](assets/image-20210711155915636.png)

- 第3条

![image-20210711155948399](assets/image-20210711155948399.png)

- 第4条

![image-20210711160014043](assets/image-20210711160014043.png)

- 最后结果（0100H，即$16^2$，即$2^8$）

![image-20210711160228657](assets/image-20210711160228657.png)



### 任务3：查看主板信息并尝试修改

---

- 主板ROM的生产日期，在内存FFF00H~FFFFFH的某些单元中
- 找了一下，结果是30 31 2F 30 32 2F 39 32，对应的字符串为“01/01/92”，其中30H对应的十进制ASCII码为48，对应的字符是'0'

![image-20210711172535616](assets/image-20210711172535616.png)

- 试图修改该生产日期
- 尝试后无法进行修改，进一步说明ROM的内容是只读的，无法进行修改的

![image-20210711173654835](assets/image-20210711173654835.png)



### 任务4：向指定内存单元填写数据

---

- 向B8100H内存空间写入数据，修改后屏幕的第二行出现了彩色的字母
- 在8086pc机中，B8100H保存的是显存的内容，而且对应的是DOS屏幕第二行大概中间的位置
- 在B8100H的单元里，用16位内存来单元来存储要显示的信息，第一个8位保存字符的ASCII码，第二个8位保存字符的颜色，如30H是ASCII的48，即字符‘1’
- 比如 b800:0000这段内存 是显存部分，你在这段内存中写东西会直接反映在屏幕中，所以你会看到屏幕中一些变化，但是当你不再改变它时候，会别其他的数据覆盖掉，因为你每回一次车，屏幕要上滚，实际就是在往显存中写东西，你以前的东西就会被覆盖掉了

![image-20210711231620174](assets/image-20210711231620174.png)



### 任务3、4的共同知识点

---

- 8086PC机的内存地址空间分配

00000H ~ 9FFFFH 主存储器RAM

A0000H ~ BFFFFH 显存地址空间

C0000H ~ FFFFFH 各类ROM